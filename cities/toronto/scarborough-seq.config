# ========================================================================
# Configuration file for ridehail simulation of Toronto
# Data from Toronto city review at 
# https://www.toronto.ca/legdocs/mmis/2019/gl/bgrd/backgroundfile-134426.pdf
# Tom Slee, 2020-09-09
# ========================================================================

[DEFAULT]

# ------------------------------------------------------------------------
# Title (string, default None)
# Plot title
# ------------------------------------------------------------------------

title = Scarborough, 1 block = 1 min

# ------------------------------------------------------------------------
# City size (integer, default 10)
# The length of the city grid, in blocks.
# Scarborough has an area of 188 km^2, which is roughly 14km * 14 km
# ------------------------------------------------------------------------

city_size = 28

# ------------------------------------------------------------------------
# Starting vehicle count (integer, default 1) 
# The number of vehicles in the simulation. For simulations with 
# equilibration (see below), this is the number of vehicles at the 
# beginning of the simulation
# From N = 28.8 R + 274 (Toronto Report 1, p A10), 
# for R = 3 (Oct 2016) and R = 10 (Sep 2018): N = 360 or 562
# ------------------------------------------------------------------------

vehicle_count = 500

# ------------------------------------------------------------------------
# Base demand (float)
# An exogenous demand: actual demand = base demand - price
# R = 3 (2016) or 10 (2018) requests per minute
# If speed limits are 60--70 kph on major roads and 40-50 on minor roads,
# one km = one minute is not too bad
# ------------------------------------------------------------------------

base_demand = 1

# ------------------------------------------------------------------------
# Time blocks (integer)
# The number of time blocks to run the simulation. Each block corresponds
# to a vehicle travelling one block
# ------------------------------------------------------------------------

time_blocks = 640

# ------------------------------------------------------------------------
# Minimum trip distance (integer, default 0)
# A trip must be at least this long
# ------------------------------------------------------------------------

min_trip_distance = 0

# ------------------------------------------------------------------------
# Maximum trip distance (even integer, default city_size)
# A trip must be at most this long
# ------------------------------------------------------------------------

max_trip_distance = 28

# ------------------------------------------------------------------------
# Window (integer, default = 20)
# Rolling window in which to compute trailing averages (wait times, busy
# fraction etc) that are used in graphs and in calculations.
# ------------------------------------------------------------------------

trailing_window = 20

# ------------------------------------------------------------------------
# Results Window (integer, default = 100)
# At the end of the run, compute the final results by averaging over
# this results_window number of blocks. Typically bigger than 
# trailing_window
# ------------------------------------------------------------------------

results_window = 240

# ------------------------------------------------------------------------
# Trip inhomogeneity (float in [0,1], default = 0.0)
# The more trip inhomogeneity, the more trips start in the city center
# Start off homogeneous
# ------------------------------------------------------------------------

trip_inhomogeneity = 0.25

# ------------------------------------------------------------------------
# Available vehicles moving (boolean, default False)
# Set to True if vehicles in the "idle" state should vehicle around
# the city. Set to False is they should stay where they are.
# ------------------------------------------------------------------------

idle_vehicles_moving = True 

# ------------------------------------------------------------------------
# Log file (string, default None)
# Log file name. By default, log messages are written to standard output
# only.
# ------------------------------------------------------------------------

log_file = 

# ------------------------------------------------------------------------
# Verbosity (integer, default 0)
# If 1, log info messages in addition to warning, and 
# error messages
# If 2, log debug messages in addition to information, warning, and 
# error messages
# ------------------------------------------------------------------------

verbosity = 0

# ------------------------------------------------------------------------
# Animation (binary, default False)
# If true, display or save animation.
# Animation configuration is in the [ANIMATION] section
# ------------------------------------------------------------------------

animation = True

# ------------------------------------------------------------------------
# Equilibration (choice from supply, price, none. Default None)
# Equilibrate the number of vehicles (supply), the request rate (demand)
# or full. The details of the parameter choices and equilibration rates
# are given in other parameters
# ------------------------------------------------------------------------

equilibration = True  

# ------------------------------------------------------------------------
# Run sequence (boolean, default False)
# Set to True to run a sequence of simulations with different vehicle 
# counts and request rates
# ------------------------------------------------------------------------

sequence = True

[ANIMATION]

# ------------------------------------------------------------------------
# Animate
# Select which charts and / or maps to display. 
# Possible values include 
#   - none (no charts)
#   - map 
#   - stats
#   - all (map + stats_
#   - bar
#   - sequence
# ------------------------------------------------------------------------

animate = none

# ------------------------------------------------------------------------
# Animate update period (integer, default 1)
# Update charts every N periods
# ------------------------------------------------------------------------

animate_update_period = 1

# ------------------------------------------------------------------------
# ImageMagick_Dir (string)
# If you choose an MP4 or GIF output (output parameter) then you need 
# ImageMagick installed. This is the directory in which it is installed, 
# for example:
#
#   imagemagick_dir = /Program Files/ImageMagick-7.0.9-Q16" 
# ------------------------------------------------------------------------

imagemagick_dir = /Program Files/ImageMagick-7.0.9-Q16

# ------------------------------------------------------------------------
# Smoothing Window (integer, default = 20)
# Rolling window in which to compute trailing averages (wait times, busy
# fraction etc) that are used in graphs and in calculations.
# ------------------------------------------------------------------------

smoothing_window = 20

# ------------------------------------------------------------------------
# Animation output (string, default None)
# Supply a file name in which to save the animations. If none is supplied,
# any animations are displayed on the screen only.
# ------------------------------------------------------------------------

animation_output = none 

[EQUILIBRATION]
# ------------------------------------------------------------------------
# Equilibration method. Should usually be "None" or "Price"
# ------------------------------------------------------------------------

equilibrate = price

# ------------------------------------------------------------------------
# Price (float, default 1)
# Has effect only if an equilibration method is chosen
# Price is a part of the equilibration path
# ------------------------------------------------------------------------

price = 1

# ------------------------------------------------------------------------
# Platform commission F (float, default 0.0)
# Has effect only if an equilibration method is chosen and affects supply.
# The vehicle utility per block is U = P.B.(1 - F) - C_d, 
# where F = platform commission. F > 0 amounts to the platform taking a 
# commission, F < 0 is the platform subsidizing vehicles.
# ------------------------------------------------------------------------

platform_commission = 0.0

# ------------------------------------------------------------------------
# Reserved wage (float, default 1)
# Has effect only if an equilibration method is chosen and affects supply.
# The vehicle utility per block is U = P.B - C_d, where C_d = reserved wage
# ------------------------------------------------------------------------

reserved_wage = 0.48

# ------------------------------------------------------------------------
# Demand elasticity (float, default 1.0)
# Has effect only if an equilibration method is chosen and affects supply.
# The demand (request rate) = k * p ^ (-r) 
# where r is the demand elasticity and k is the base demand
# ------------------------------------------------------------------------

demand_elasticity = 0.0

# ------------------------------------------------------------------------
# Equilibration interval (int)
# Has effect only if an equilibration method is chosen and affects demand.
# The number of blocks at which equilibration steps are chosen
# ------------------------------------------------------------------------

equilibration_interval = 5


# [IMPULSES]

# ------------------------------------------------------------------------
# Sudden changes during the simulation
# Write as a list of dictionaries.
# ------------------------------------------------------------------------

# impulse_list = [
#   {"block": 00 * 60, "base_demand":  20},
#    {"block":  8 * 60, "base_demand": 150},
#    {"block": 10 * 60, "base_demand": 100},
#    {"block": 16 * 60, "base_demand": 150},
#    {"block": 20 * 60, "base_demand": 120},
#    {"block": 22 * 60, "base_demand": 100},
#    {"block": 23 * 60, "base_demand":  60},
#    ]

[SEQUENCE]
# ------------------------------------------------------------------------
# Run a sequence of simulations
# ------------------------------------------------------------------------

# ------------------------------------------------------------------------
# Reques rate repeat (int)
# How many times to repeat each request_rate (to build up statistics)
# ------------------------------------------------------------------------

request_rate_repeat = 1

# ------------------------------------------------------------------------
# Driver count increment (int)
# Loop over vehicle counts, starting with vehicle_count (above), in
# increments of vehicle_count_increment, with a max of vehicle_count_max
# ------------------------------------------------------------------------

# vehicle_count_increment = 100

# ------------------------------------------------------------------------
# Driver count max (int)
# Loop over vehicle counts, starting with vehicle_count (above), in
# increments of vehicle_count_increment, with a max of vehicle_count_max
# ------------------------------------------------------------------------

# vehicle_count_max = 8000

# ------------------------------------------------------------------------
# Price max
# Loop over prices, starting with vehicle_count (above), in
# increments of vehicle_count_increment, with a max of vehicle_count_max
# ------------------------------------------------------------------------

# price_max = 1

# ------------------------------------------------------------------------
# Request rate increment (float) -- INACTIVE
# Loop over request rates, starting with request_rate (above), in
# increments of request_rate_increment, with a max of request_rate_max.
# Only one decimal place is relevant
# ------------------------------------------------------------------------

request_rate_increment = 1

# ------------------------------------------------------------------------
# Request rate max (float) -- INACTIVE
# Loop over request rates, starting with request_rate (above), in
# increments of request_rate_increment, with a max of request_rate_max.
# Only one decimal place is relevant
# ------------------------------------------------------------------------

request_rate_max = 50.0

# ========================================================================
# END
# ========================================================================


