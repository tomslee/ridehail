<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <title>Ridehail Playground</title>
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,400,500,700">
    <!--  Material Design: se https://getmdl.io/started/index.html -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <!-- theme from https://getmdl.io/customize/index.html -->
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.green-pink.min.css">
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- <script src="./d3/d3.v7.min.js"></script> -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-colorschemes"></script> -->
    <!-- rendering on mobile devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
</head>
<body>
    <!-- Always shows a header, even in smaller screens. -->
    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
        <header class="mdl-layout__header">
            <div class="mdl-layout__header-row">
                <!-- Title -->
                <span class="mdl-layout-title"><b>Ridehail Playground (Proof of Concept only!)</b><br> Choose city size, vehicle count, and other parameters, and simulate a ridehail system. </span>
                <!-- Add spacer, to align navigation to the right -->
                <div class="mdl-layout-spacer"></div>
                <!-- Navigation. We hide it in small screens. -->
                <nav class="mdl-navigation mdl-layout--large-screen-only">
                    <a class="mdl-navigation__link" href="https://github.com/tomslee/ridehail-animation">GitHub</a>
                    <a class="mdl-navigation__link" href="https://github.com/tomslee/ridehail-animation/blob/dev/LICENSE">License</a>
                </nav>
            </div>
            <!-- Tabs -->
            <div class="mdl-layout__tab-bar mdl-js-ripple-effect">
                <a href="#scroll-tab-1" class="mdl-layout__tab is-active">Playground</a>
                <a href="#scroll-tab-2" class="mdl-layout__tab">Storytime</a>
            </div>
        </header>
        <main class="mdl-layout__content">
            <section class="mdl-layout__tab-panel is-active" id="scroll-tab-1">
                <div class="page-content">
                    <!-- Your content goes here -->
                    <div class="mdl-grid">
                        <div class="mdl-cell mdl-cell--12-col">
                            <h5>Introduction</h5>
                            <p>
                                This page runs a model of a ridehail system, such as Uber or Lyft, in a city. The model is written in python and was inspired in part by this
                                <a href="https://www.nytimes.com/interactive/2017/04/02/technology/uber-drivers-psychological-tricks.html">2017 New York Times interactive visualization</a>
                                (scroll down that page a bit). It runs in the browser using the
                                <a href="https://pyodide.org">Pyodide</a>
                                distribution, the UI is built with
                                <a href="https://getmdl.io/started/index.html">Material Design Lite</a>
                                , and the page construction takes inspiration from the
                                <a href="https://playground.tensorflow.org/">TensorFlow Playground</a>
                                . They are not to blame for any problems.
                            </p>
                            <div id="run-controls">
                                <p>
                                    Choose your simulation and display options below, and then run the simulation with these controls
                                </p>
                                <button class="mdl-button mdl-js-button mdl-button--icon ui-resetButton" id="reset-button" title="Reset the ridehail system" disabled>
                                    <i class="material-icons">replay</i>
                                </button>
                                <button id="fab-button" class="mdl-button mdl-js-button mdl-button--fab mdl-button--colored" disabled>
                                    <i class="material-icons">play_arrow</i>
                                </button>
                                <button class="mdl-button mdl-js-button mdl-button--icon ui-stepButton" id="next-step-button" title="Step" disabled>
                                    <i class="material-icons">skip_next</i>
                                </button>
                                <span class="label">Frame: </span>
                                <span class="value" id="frame-count">0</span>
                            </div>
                        </div>
                        <div id="simulation-options" class="mdl-cell mdl-cell--4-col">
                            <h5>Simulation options</h5>
                            <p>
                                In this model, a city is a square grid. Its size is the number of
                                <b>blocks</b>
                                on each side of the square. A block is a measure of both time and distance. You can think of a block as typically about one minute or a "city block" in some North American city.
                            </p>
                            <p>
                                City size:
                                <span id="option-city-size">24</span>
                                blocks
                                <input id="input-city-size" class="mdl-slider mdl-js-slider" type="range" min="0" max="64" value="24" step="4">
                            </p>
                            <p>
                                Vehicle count:
                                <span id="option-vehicle-count">1</span>
                                vehicles
                                <input id="input-vehicle-count" class="mdl-slider mdl-js-slider" type="range" min="0" max="128" value="1" step="1">
                            </p>
                            <p>
                                Request rate:
                                <span id="option-request-rate">0.1</span>
                                request per block
                                <input id="input-request-rate" class="mdl-slider mdl-js-slider" type="range" min="0" max="32" value="0.1" step="0.1">
                            </p>
                        </div>
                        <div id="display-options" class="mdl-cell mdl-cell--4-col">
                            <h5>Display options</h5>
                            Control the way that the output is displayed.
                            <p>
                                Chart type:
                                <span id="option-chart-type">Map</span>
                                <form>
                                    <label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-map">
                                        <input type="radio" id="option-map" class="mdl-radio__button" name="options" value="Map" checked>
                                        <span class="mdl-radio__label">Map</span>
                                    </label>
                                    <label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-stats">
                                        <input type="radio" id="option-stats" class="mdl-radio__button" name="options" value="Stats">
                                        <span class="mdl-radio__label">Stats</span>
                                    </label>
                                </form>
                            </p>
                            <p>
                                Smoothing window (stats plot only):
                                <span id="option-smoothing-window">5</span>
                                blocks
                                <input id="input-smoothing-window" class="mdl-slider mdl-js-slider" type="range" min="1" max="32" value="5" step="1">
                            </p>
                            <p>
                                Timeout between frames:
                                <span id="option-frame-timeout">100</span>
                                milliseconds
                                <input id="input-frame-timeout" class="mdl-slider mdl-js-slider" type="range" min="0" max="1000" value="100" step="10">
                            </p>
                        </div>
                        <div id="div-chart" class="mdl-cell mdl-cell--4-col">
                            <canvas id="pg-chart-canvas" class="pg-chart-canvas" height="100%" width="100%"></canvas>
                            <!--  MDL spinner -->
                            <div id="spinner" class="mdl-spinner mdl-js-spinner is-active"></div>
                        </div>
                    </div>
                </div>
            </section>
            <section class="mdl-layout__tab-panel" id="scroll-tab-2">
                <div class="page-content">
                    <div class="mdl-grid">
                        <div id="st1-grid" class="mdl-cell mdl-cell--6-col-desktop mdl-cell--3-offset-desktop" margin:auto="">
                            <h4>Ridehailing</h4>
                            <p>
                                Start with a city, which is a square grid with a number of "blocks" on each side.
                            </p>
                            <p>
                                A vehicle drives randomly around the city. If it goes off one edge of the city, it appears on the opposite edge. This turns out to be a useful simplification. You can also think of it as some vehicles leaving the city, and others entering.
                            </p>
                            <div class="button-and-chart">
                                <div class="st-button-parent">
                                    <button id="st1-button" class="mdl-button mdl-js-button mdl-button--fab mdl-button--mini-fab">
                                        <i class="material-icons">play_arrow</i>
                                    </button>
                                </div>
                                <div class="st-canvas-parent" id="st1-chart" style="position: relative;
                                height:20vh; width:12vw;
                                padding-left: 20px">
                                    <canvas id="st1-chart-canvas" class="st1-chart-canvas" style="height:20vh;width:12vw"></canvas>
                                </div>
                            </div>
                            <div>
                                <p>
                                    In addition to vehicles, we need trips. Here is a vehicle driving around, and occasionally picking up a passenger for a trip.
                                </p>
                                <p>
                                    The vehicle can be in three "phases".
                                    <ul>
                                        <li>
                                            P1: it does not have a trip assigned, and is available. Sometimes this is called 'idle'. It is shown in blue.
                                        </li>
                                        <li>
                                            P2: 'en route' to pick up a passenger. It is shown in an 'amber' colour.
                                        </li>
                                        <li>
                                            P3: busy. The vehicle has a passenger
                                        </li>
                                    </ul>
                                </p>
                                <p>
                                    The trip origin is marked by a red diamond, and the trip destination (which shows up once the vehicle has picked up the passenger) is shown as a red circle (think of it as a target).
                                </p>
                                <p>
                                    When the red diamond is shown, the passenger is in a "waiting" state. When the red circle is shown, the passenger is in the vehicle.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>
    <!--
      <footer class="mdl-mini-footer">
        <div class="mdl-mini-footer__left-section">
          <div class="mdl-logo">Ridehail playground</div>
          <ul class="mdl-mini-footer__link-list">
            <li>Copyright (c) Tom Slee, 2022</li>
            <li><a href="https://github.com/tomslee/ridehail-animation">GitHub
                ReadMe</a></li>
            <li><a href="https://github.com/tomslee/ridehail-animation/blob/dev/LICENSE">Privacy & Terms</a></li>
          </ul>
        </div>
      </footer>
      -->
    <script defer type="module" src="./main.js"></script>
</body>
</html>
